import{u as _,j as e,B as o,L as c,I as p,C as g,a as N,b as E,c as D,d as B,e as S}from"./index-8HvWlEO9.js";import{r as v,k as T,c as F,U as k,S as q,l as A,B as O,g as z}from"./vendor-ui-BfR-HH66.js";import{D as I,a as P,b as V,c as H,d as L,e as M,f as R}from"./dialog-BJngghRx.js";import{f as G}from"./vendor-date-OvfWL3xb.js";import{p as J}from"./pt-BR-nHefkTwq.js";import"./vendor-react-CRB3T2We.js";function Z({profiles:h,companies:d=[],onAddUser:n,onDeleteUser:t}){const{user:i}=_(),l=(i==null?void 0:i.role)==="admin",[y,m]=v.useState(!1),[s,r]=v.useState({email:"",name:"",role:"client",company_id:""}),b=async()=>{if(!(!s.email||!s.name)){if(s.role==="client"&&!s.company_id){alert("Selecione uma empresa para o usuário cliente");return}try{await(n==null?void 0:n({email:s.email,name:s.name,role:s.role,company_id:s.role==="client"?s.company_id:void 0})),r({email:"",name:"",role:"client",company_id:""}),m(!1)}catch(a){console.error("Erro ao adicionar usuário:",a)}}},f=async a=>{if(confirm("Tem certeza que deseja excluir este usuário?"))try{await(t==null?void 0:t(a))}catch(x){console.error("Erro ao excluir usuário:",x)}},w=a=>{try{return G(new Date(a),{addSuffix:!0,locale:J})}catch{return"Data indisponível"}},u=l?h:h.filter(a=>a.company_id===(i==null?void 0:i.company_id));return e.jsxs("div",{className:"p-8 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Equipe"}),e.jsx("p",{className:"text-slate-600 text-lg",children:l?"Gerencie todos os usuários do sistema":"Visualize os membros da sua equipe"})]}),l&&n&&e.jsxs(I,{open:y,onOpenChange:m,children:[e.jsx(P,{asChild:!0,children:e.jsxs(o,{className:"bg-[#2563EB] hover:bg-[#1d4ed8]",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Novo Usuário"]})}),e.jsxs(V,{children:[e.jsxs(H,{children:[e.jsx(L,{children:"Adicionar Novo Usuário"}),e.jsx(M,{children:"Crie um novo usuário no sistema. O usuário receberá um email para configurar sua senha."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"name",children:"Nome Completo *"}),e.jsx(p,{id:"name",placeholder:"João Silva",value:s.name,onChange:a=>r({...s,name:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"email",children:"Email *"}),e.jsx(p,{id:"email",type:"email",placeholder:"joao@empresa.com",value:s.email,onChange:a=>r({...s,email:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"role",children:"Perfil *"}),e.jsxs("select",{id:"role",className:"w-full p-2 border border-slate-300 rounded-md",value:s.role,onChange:a=>r({...s,role:a.target.value,company_id:""}),children:[e.jsx("option",{value:"client",children:"Cliente (Viewer)"}),e.jsx("option",{value:"admin",children:"Administrador"})]})]}),s.role==="client"&&d.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"company_id",children:"Empresa *"}),e.jsxs("select",{id:"company_id",className:"w-full p-2 border border-slate-300 rounded-md",value:s.company_id,onChange:a=>r({...s,company_id:a.target.value}),children:[e.jsx("option",{value:"",children:"Selecione uma empresa..."}),d.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]})]}),e.jsxs(R,{children:[e.jsx(o,{variant:"outline",onClick:()=>m(!1),children:"Cancelar"}),e.jsx(o,{className:"bg-[#2563EB] hover:bg-[#1d4ed8]",onClick:b,disabled:!s.email||!s.name||s.role==="client"&&!s.company_id,children:"Adicionar"})]})]})]})]}),u.length===0?e.jsx(g,{className:"text-center py-12",children:e.jsxs(N,{children:[e.jsx(F,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-medium text-slate-600 mb-2",children:"Nenhum usuário encontrado"}),e.jsx("p",{className:"text-slate-500",children:l?"Comece adicionando usuários usando o botão acima.":"Nenhum membro da equipe encontrado."})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(a=>{var j;const x=((j=d.find(C=>C.id===a.company_id))==null?void 0:j.name)||"N/A";return e.jsxs(g,{className:"hover:shadow-md transition-shadow",children:[e.jsxs(E,{children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("div",{className:"w-12 h-12 bg-[#2563EB]/10 rounded-full flex items-center justify-center",children:e.jsx(k,{className:"w-6 h-6 text-[#2563EB]"})}),e.jsx(D,{variant:a.role==="admin"?"default":"secondary",children:a.role==="admin"?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-3 h-3 mr-1"}),"Admin"]}):"Cliente"})]}),e.jsx(B,{className:"text-lg",children:a.name}),e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),a.email]})]}),e.jsxs(N,{children:[a.company_id&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600 mb-4",children:[e.jsx(O,{className:"w-4 h-4"}),e.jsx("span",{children:x})]}),e.jsxs("div",{className:"text-xs text-slate-500",children:["Membro desde ",w(a.created_at)]}),l&&t&&e.jsxs(o,{variant:"ghost",size:"sm",className:"w-full mt-4 text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>f(a.id),children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Excluir Usuário"]})]})]},a.id)})})]})}export{Z as TeamView};
